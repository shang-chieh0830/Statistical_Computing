<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Random number generation | Statistical Computing</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Random number generation | Statistical Computing" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="shang-chieh0830/Statistical_Computing" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Random number generation | Statistical Computing" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Shang-Chieh" />


<meta name="date" content="2023-03-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistical Computing</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a></li>
<li class="chapter" data-level="2" data-path="random-number-generation.html"><a href="random-number-generation.html"><i class="fa fa-check"></i><b>2</b> Random number generation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="random-number-generation.html"><a href="random-number-generation.html#pseudo-random-number-generators"><i class="fa fa-check"></i><b>2.1</b> Pseudo random number generators</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="random-number-generation.html"><a href="random-number-generation.html#structure-of-prng-in-computer"><i class="fa fa-check"></i><b>2.1.1</b> Structure of PRNG in computer</a></li>
<li class="chapter" data-level="2.1.2" data-path="random-number-generation.html"><a href="random-number-generation.html#quality-of-prngs"><i class="fa fa-check"></i><b>2.1.2</b> Quality of PRNGs</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="random-number-generation.html"><a href="random-number-generation.html#the-inverse-transform-method"><i class="fa fa-check"></i><b>2.2</b> The inverse transform method</a></li>
<li class="chapter" data-level="2.3" data-path="random-number-generation.html"><a href="random-number-generation.html#rejection-sampling"><i class="fa fa-check"></i><b>2.3</b> Rejection sampling</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Computing</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="random-number-generation" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Random number generation<a href="random-number-generation.html#random-number-generation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="pseudo-random-number-generators" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Pseudo random number generators<a href="random-number-generation.html#pseudo-random-number-generators" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="definition">
<p><span id="def:unlabeled-div-1" class="definition"><strong>Definition 2.1  </strong></span><strong>PRNG</strong></p>
<p>A PRNG is an <strong>algorithm</strong> which outputs a sequence of numbers, which can be used as a <strong>replacement</strong> for an i.i.d. sequence of random numbers.</p>
</div>
<div id="structure-of-prng-in-computer" class="section level3 hasAnchor" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Structure of PRNG in computer<a href="random-number-generation.html#structure-of-prng-in-computer" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>States: <span class="math inline">\(s_0\xrightarrow{f} s_1 \xrightarrow{f} s_2 \xrightarrow{f} s_3 \xrightarrow{f} \dots\)</span></p>
<p>Each state gives a random number :
<span class="math display">\[s_1\xrightarrow{g}X_1\\
s_2\xrightarrow{g}X_2\\
s_3\xrightarrow{g}X_3\\
\vdots\]</span></p>
<p>where <span class="math inline">\(s_i\in S.\)</span> Here, <span class="math inline">\(S\)</span> is called the state space, <span class="math inline">\(f:S\to S\)</span> is called the mixing function and <span class="math inline">\(g:S\to \mathscr R\)</span> is called the output function.</p>
<p>Note that <span class="math inline">\(s_0\)</span> is never computed, <span class="math inline">\(s_0\)</span> is called the seed.</p>
<p><strong>Linear congruential generator (LCG)</strong></p>
<p><span class="math inline">\(mod \quad m\)</span> means that we divide by m and take the remainder(對m取餘)</p>
<p><span class="math inline">\(X_n=a(X_{n-1}+c)\quad mod \quad m,\)</span> where <span class="math inline">\(X_n \in \{0,1,...,m-1\}, a\in \{1,2,...,m-1\}\)</span>, a is called the multiplier; <span class="math inline">\(c\in \{0,1,...,m-1\}\)</span>, c is called the increment; <span class="math inline">\(m\in \mathcal N=\{1,2,3,...\}\)</span>, m is called the modulus.</p>
<p>Under LCG, there’s no difference between X and s. That is,
<span class="math inline">\(X_n\in\{0,1,...,m-1\}:=S,\quad g(s)=s, \quad f(X)=(aX+c)\quad mod\quad m\)</span></p>
<p><span class="math inline">\(X_0\in S\)</span> is the seed in LCG.</p>
<div class="example">
<p><span id="exm:unlabeled-div-2" class="example"><strong>Example 2.1  </strong></span><strong>LCG with <span class="math inline">\(m=8, a=5, c=1, X_0=0\)</span></strong></p>
<p><span class="math inline">\(X_1=(aX_0+c)\quad mod\quad m =(5\times 0+1)\quad mod\quad8=1\)</span>
<span class="math inline">\(X_2=(aX_1+c)\quad mod\quad m =(5\times 1+1)\quad mod\quad8=6\)</span>
<span class="math inline">\(X_3=(aX_2+c)\quad mod\quad m =(5\times 6+1)\quad mod\quad8=7\)</span></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="random-number-generation.html#cb1-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb1-2"><a href="random-number-generation.html#cb1-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb1-3"><a href="random-number-generation.html#cb1-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1-4"><a href="random-number-generation.html#cb1-4" aria-hidden="true" tabindex="-1"></a>X0 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-5"><a href="random-number-generation.html#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="random-number-generation.html#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="random-number-generation.html#cb1-7" aria-hidden="true" tabindex="-1"></a>Xi <span class="ot">&lt;-</span> X0</span>
<span id="cb1-8"><a href="random-number-generation.html#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb1-9"><a href="random-number-generation.html#cb1-9" aria-hidden="true" tabindex="-1"></a>  Xi <span class="ot">&lt;-</span> (a<span class="sc">*</span>Xi <span class="sc">+</span> c)<span class="sc">%%</span>m</span>
<span id="cb1-10"><a href="random-number-generation.html#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;X_&quot;</span>, i, <span class="st">&quot; = &quot;</span>, Xi, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb1-11"><a href="random-number-generation.html#cb1-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## X_1 = 1
## X_2 = 6
## X_3 = 7
## X_4 = 4
## X_5 = 5
## X_6 = 2
## X_7 = 3
## X_8 = 0
## X_9 = 1
## X_10 = 6</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="random-number-generation.html#cb3-1" aria-hidden="true" tabindex="-1"></a>rLCG <span class="ot">&lt;-</span> <span class="cf">function</span>(n, m, a, c, X0){</span>
<span id="cb3-2"><a href="random-number-generation.html#cb3-2" aria-hidden="true" tabindex="-1"></a>  Xi <span class="ot">&lt;-</span> X0</span>
<span id="cb3-3"><a href="random-number-generation.html#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb3-4"><a href="random-number-generation.html#cb3-4" aria-hidden="true" tabindex="-1"></a>    Xi <span class="ot">&lt;-</span> (a<span class="sc">*</span>Xi <span class="sc">+</span> c)<span class="sc">%%</span>m</span>
<span id="cb3-5"><a href="random-number-generation.html#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;X_&quot;</span>, i, <span class="st">&quot; = &quot;</span>, Xi, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb3-6"><a href="random-number-generation.html#cb3-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-7"><a href="random-number-generation.html#cb3-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-8"><a href="random-number-generation.html#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="random-number-generation.html#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rLCG</span>(<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span></code></pre></div>
<pre><code>## X_1 = 1
## X_2 = 6
## X_3 = 7
## X_4 = 4
## X_5 = 5</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="random-number-generation.html#cb5-1" aria-hidden="true" tabindex="-1"></a>rLCG <span class="ot">&lt;-</span> <span class="cf">function</span>(n, m, a, c, X0){</span>
<span id="cb5-2"><a href="random-number-generation.html#cb5-2" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb5-3"><a href="random-number-generation.html#cb5-3" aria-hidden="true" tabindex="-1"></a>  Xi <span class="ot">&lt;-</span> X0</span>
<span id="cb5-4"><a href="random-number-generation.html#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb5-5"><a href="random-number-generation.html#cb5-5" aria-hidden="true" tabindex="-1"></a>    Xi <span class="ot">&lt;-</span> (a<span class="sc">*</span>Xi <span class="sc">+</span> c)<span class="sc">%%</span>m</span>
<span id="cb5-6"><a href="random-number-generation.html#cb5-6" aria-hidden="true" tabindex="-1"></a>    result[i] <span class="ot">&lt;-</span> Xi</span>
<span id="cb5-7"><a href="random-number-generation.html#cb5-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-8"><a href="random-number-generation.html#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb5-9"><a href="random-number-generation.html#cb5-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-10"><a href="random-number-generation.html#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="random-number-generation.html#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="fu">rLCG</span>(<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [1] 1 6 7 4 5</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="random-number-generation.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rLCG</span>(<span class="dv">16</span>,<span class="dv">8</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span></code></pre></div>
<pre><code>##  [1] 1 6 7 4 5 2 3 0 1 6 7 4 5 2 3 0</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="random-number-generation.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Did you notice that it just repeat itself?</span></span>
<span id="cb9-2"><a href="random-number-generation.html#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This will be discuss later with the quality of PRNG</span></span>
<span id="cb9-3"><a href="random-number-generation.html#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># also notice m=8, so it repeats itself every 8 numbers</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="random-number-generation.html#cb10-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rLCG</span>(<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb10-2"><a href="random-number-generation.html#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="random-number-generation.html#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X)</span></code></pre></div>
<p><img src="01-RNG_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="random-number-generation.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the defult breaks on integer, which is not good</span></span>
<span id="cb11-2"><a href="random-number-generation.html#cb11-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rLCG</span>(<span class="dv">100000</span>, <span class="dv">8</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb11-3"><a href="random-number-generation.html#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(X) </span></code></pre></div>
<p><img src="01-RNG_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="random-number-generation.html#cb12-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rLCG</span>(<span class="dv">100000</span>, <span class="dv">8</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb12-2"><a href="random-number-generation.html#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(X, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">7.5</span>, <span class="dv">1</span>)) </span></code></pre></div>
<p><img src="01-RNG_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="random-number-generation.html#cb13-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rLCG</span>(<span class="dv">10</span>, <span class="dv">8</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb13-2"><a href="random-number-generation.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(X, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">7.5</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="01-RNG_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="random-number-generation.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rLCG</span>(<span class="dv">10</span>, <span class="at">m=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">31</span>, <span class="at">a=</span><span class="dv">1103515245</span>, <span class="at">c=</span><span class="dv">12345</span>, <span class="at">X0=</span><span class="dv">0</span>)</span></code></pre></div>
<pre><code>##  [1]      12345 1406932606  654583808 1358247936 2138638336 1459132416
##  [7] 1445521408  370866176 1896597568 1518859008</code></pre>
</div>
<p>LCG is outdated nowadays, the purpose of introducing this method is to give you a general understanding of how pseudo random numbers are produced in computer.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="random-number-generation.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the normal way to choose seed</span></span>
<span id="cb16-2"><a href="random-number-generation.html#cb16-2" aria-hidden="true" tabindex="-1"></a>?set.seed</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="random-number-generation.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb17-2"><a href="random-number-generation.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">runif</span>(<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.8966972 0.2655087 0.3721239</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="random-number-generation.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb19-2"><a href="random-number-generation.html#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">runif</span>(<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0.2655087 0.3721239 0.5728534</code></pre>
</div>
<div id="quality-of-prngs" class="section level3 hasAnchor" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> Quality of PRNGs<a href="random-number-generation.html#quality-of-prngs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are a number of criteria.</p>
<ol style="list-style-type: decimal">
<li>Period Length</li>
</ol>
<p>The computer has only finite memory, so we can’t have infinite state space. It turns out that PRNG starts repeating itself after a while (entering the states that it has already visited).</p>
<p>The maximum period length is <span class="math inline">\(|S|\)</span>.</p>
<p>For LCG, <span class="math inline">\(S=\{0,1,...,m-1\} \implies |S|=m\)</span></p>
<p>Note that random numbers never repeat, but pseudo random numbers DO!!
But fortunately, we can have extremely large period in R.</p>
<p>Good PRNG have large period.</p>
<ol start="2" style="list-style-type: decimal">
<li>Distribution of samples</li>
</ol>
<p>Aim: generate uniformly distributed samples.<span class="math inline">\(U(0,1)\)</span></p>
<p>For LCG, <span class="math inline">\(X_n \in \{0,1,...,m-1\}\)</span>, and we’ve seen from previous examples that LCG is indeed uniformly distributed from <span class="math inline">\(\{0,1,...,m-1\}\)</span>, note that this is not <span class="math inline">\(U(0,1)\)</span> but at least it’s uniformly distributed.</p>
<p>To get <span class="math inline">\(U(0,1)\)</span>, use the transformation <span class="math inline">\(U_n:=\frac{X_n+1}{m+1}\in (0,1)\)</span> for large m.</p>
<p>You can use histogram or check whether the PRNG visits each state exactly once (which then produces every pseudo number once) within its maximum period length.</p>
<p>Better criterion: PRNG output passes statistical tests for uniform distribution w/o problems (check example 1.6 in the book)</p>
<ol start="3" style="list-style-type: decimal">
<li>Independence of samples</li>
</ol>
<p>You can just plot <span class="math inline">\(X_n\)</span> and <span class="math inline">\(X_{n-1}\)</span> on x-axis and y-axis respectively.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="random-number-generation.html#cb21-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rLCG</span>(<span class="dv">1000</span>,<span class="dv">8</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb21-2"><a href="random-number-generation.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># m=8 which means small state space, you won&#39;t expect this small m gives you uniformly distributed plot</span></span>
<span id="cb21-3"><a href="random-number-generation.html#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="random-number-generation.html#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>], X[<span class="dv">2</span><span class="sc">:</span><span class="dv">1000</span>])</span></code></pre></div>
<p><img src="01-RNG_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="random-number-generation.html#cb22-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rLCG</span>(<span class="dv">1000</span>, <span class="at">m=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">32</span>, <span class="at">a=</span><span class="dv">1103515245</span>, <span class="at">c=</span><span class="dv">12345</span>, <span class="at">X0=</span><span class="dv">0</span>)</span>
<span id="cb22-2"><a href="random-number-generation.html#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="random-number-generation.html#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>], X[<span class="dv">2</span><span class="sc">:</span><span class="dv">1000</span>])</span></code></pre></div>
<p><img src="01-RNG_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="random-number-generation.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># well, it now looks like uniformly distributed</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="random-number-generation.html#cb24-1" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> (X<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">^</span><span class="dv">32</span><span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb24-2"><a href="random-number-generation.html#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(U)</span></code></pre></div>
<pre><code>## [1] 2.874527e-06 9.979539e-01</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="random-number-generation.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">range</span>(U),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.000 0.998</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="random-number-generation.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(U[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>], U[<span class="dv">2</span><span class="sc">:</span><span class="dv">1000</span>], <span class="at">asp=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="01-RNG_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="random-number-generation.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Great, U(0,1)</span></span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="random-number-generation.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mai=</span><span class="fu">c</span>(<span class="fl">0.9</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>))</span>
<span id="cb30-2"><a href="random-number-generation.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(U[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>], U[<span class="dv">2</span><span class="sc">:</span><span class="dv">1000</span>], <span class="at">asp=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="01-RNG_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="random-number-generation.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use R&#39;s default PRNG: Mersenne-Twister</span></span>
<span id="cb31-2"><a href="random-number-generation.html#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="random-number-generation.html#cb31-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb31-4"><a href="random-number-generation.html#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>], X[<span class="dv">2</span><span class="sc">:</span><span class="dv">1000</span>])</span></code></pre></div>
<p><img src="01-RNG_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="random-number-generation.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>], X[<span class="dv">2</span><span class="sc">:</span><span class="dv">1000</span>], <span class="at">asp=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="01-RNG_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="random-number-generation.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># You can see there&#39;s no discernible pattern</span></span></code></pre></div>
<p>In fact, the states are not independent, each state is completely determined by previous state via the function f, you can check the algorithm again. So the states are definitely not independent. But what about those outputs <span class="math inline">\(X_1,X_2,...\)</span> produced by the function g? Well, then you need to choose g properly such that g will lose some information from the states and thus make those outputs <span class="math inline">\(X_1,X_2,...\)</span> independent.</p>
<p>So theoretically, they are not independent unless you can choose g cleverly.</p>
<p>From our scatter plots above, they actually look quite good.</p>
<div class="definition">
<p><span id="def:unlabeled-div-3" class="definition"><strong>Definition 2.2  </strong></span><strong>k-dimensionally equi-distributed</strong></p>
<p>A sequence of numbers is said to be k-dimensionally equidistributed if every k-tuple of possible outputs occurs equally often in this sequence.</p>
</div>
<p>For example, consider LCG with k=2, we need to consider all pairs: (1,1), (1,2), (1,3),…</p>
<p>They are 2 dimensionally equi-distributed if the frequency of all possible pairs converge to the same number.</p>
<p>k-dimensionally equi-distributed is what we would expect for a sequence of independent random numbers.</p>
<p>Good PRNG has this property for large k.</p>
<ol start="4" style="list-style-type: decimal">
<li>Role of the seed</li>
</ol>
<p>Seed will determine which of the possible output sequences of PRNG we will get.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="random-number-generation.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>) <span class="co"># always get the same output</span></span></code></pre></div>
<ul>
<li><p>Reproducible output(for reports or debugging)</p></li>
<li><p>For non-reproducible output: use techniques like current time of day as the seed.</p></li>
</ul>
</div>
</div>
<div id="the-inverse-transform-method" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> The inverse transform method<a href="random-number-generation.html#the-inverse-transform-method" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="rejection-sampling" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Rejection sampling<a href="random-number-generation.html#rejection-sampling" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"repo": "https://github.com/shang-chieh0830/Statistical_Computing"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
